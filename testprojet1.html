<!DOCTYPE html>

<html lang="fr">

<head>

    <meta charset="UTF-8">

    <title>Phaser Waves + Text Generator (Sans Assets Externes)</title>

    <script src="https://cdn.jsdelivr.net/npm/phaser@3.85.0/dist/phaser.js"></script>

    <style>

        body {

            margin: 0;

            padding: 0;

            background: #b8ffb8;

            display: flex;

            overflow: hidden;

            font-family: Arial, sans-serif;

        }

        /* Zone Phaser à gauche */

        #phaser-example {

            width: 70vw;

            height: 100vh;

        }

        /* Zone interface à droite */

        #right-panel {

            width: 30vw;

            height: 100vh;

            background: #ffffffaa;

            padding: 20px;

            box-sizing: border-box;

            backdrop-filter: blur(5px);

        }

        #right-panel h2 {

            margin-top: 0;

            color: #ff3eb5;

            font-size: 28px;

            text-align: center;

        }

        #text-input {

            width: 100%;

            padding: 12px;

            font-size: 18px;

            margin-bottom: 15px;

            border: 2px solid #ff3eb5;

            border-radius: 10px;

            outline: none;

        }

        #generate-btn {

            width: 100%;

            padding: 12px;

            background: #ff3eb5;

            color: white;

            border: none;

            border-radius: 10px;

            font-size: 20px;

            cursor: pointer;

        }

        #generate-btn:hover {

            background: #ff1ea0;

        }

        #phaser-text {

            margin-top: 30px;

            height: 60vh;

            border: 2px dashed #ff3eb5;

            border-radius: 10px;

            padding: 10px;

            color: #ff3eb5;

        }

    </style>

</head>

<body>

<!-- Zone Animation -->

<div id="phaser-example"></div>

<!-- Zone Interface -->

<div id="right-panel">

    <h2>Créer une animation avec ton texte</h2>

    <input id="text-input" type="text" placeholder="Écris un mot ou une phrase…">

    <button id="generate-btn">Générer l’animation</button>

    <div id="phaser-text"></div>

</div>

<script>

class Example extends Phaser.Scene

{

    constructor ()

    {

        super();

        this.phase = 0;

        this.phaseDuration = 6000;

        this.timeSincePhase = 0;

    }

    // Pas de preload car nous n'utilisons pas d'assets externes

    preload ()

    {

        // Création d'une texture temporaire pour les particules (simule 'spark')

        const graphics = this.make.graphics({ x: 0, y: 0, add: false });

        graphics.fillStyle(0xffffff, 1);

        graphics.fillCircle(10, 10, 10);

        graphics.generateTexture('spark_texture', 20, 20);

        graphics.destroy();

    }



    create ()

    {

        // Initialisation du système de particules avec la texture générée

        this.particles = this.add.particles("spark_texture");



        const shapes = ["square", "circle", "diamond"];

        const blocks = this.add.group();



        // Création des formes graphiques pour remplacer les images externes

        const size = 50; // Taille de base pour les formes

        const color = 0xff3eb5; // Couleur rose



        for (let i = 0; i < 108; i++) {

            const shapeType = shapes[i % shapes.length];

            let child;



            const graphics = this.add.graphics({ fillStyle: { color: color } });



            switch (shapeType) {

                case "square":

                    graphics.fillRect(-size / 2, -size / 2, size, size);

                    break;

                case "circle":

                    graphics.fillCircle(0, 0, size / 2);

                    break;

                case "diamond":

                    graphics.fillTriangle(0, -size / 2, size / 2, 0, 0, size / 2);

                    graphics.fillTriangle(0, -size / 2, -size / 2, 0, 0, size / 2);

                    break;

            }



            // Convertir le Graphics object en Image pour pouvoir l'utiliser dans le groupe et les tweens

            // Nous utilisons une texture temporaire pour chaque forme

            const textureKey = `shape_${i}`;

            graphics.generateTexture(textureKey, size, size);

            graphics.destroy(); // Détruire l'objet Graphics original



            child = this.add.image(0, 0, textureKey).setScale(0.3);

            child.setInteractive();



            child.on("pointerover", () => {

                this.tweens.add({

                    targets: child,

                    scale: 0.5,

                    duration: 150,

                    yoyo: true

                });

            });



            child.on("pointerdown", () => {

                this.particles.createEmitter({

                    x: child.x,

                    y: child.y,

                    speed: { min: -150, max: 150 },

                    lifespan: 500,

                    scale: { start: 0.5, end: 0 },

                    quantity: 25,

                    tint: color

                });

            });



            blocks.add(child);

        }



        Phaser.Actions.GridAlign(blocks.getChildren(), {

            width: 12,

            height: 9,

            cellWidth: 60,

            cellHeight: 60,

            x: 40,

            y: 30

        });



        this.blocks = blocks;

        this.originalPositions = blocks.getChildren().map(b => ({ x: b.x, y: b.y }));



        // TEXT ANIMATION ZONE

        this.createTextEngine();

    }

    update(time, delta)

    {

        this.timeSincePhase += delta;

        if (this.timeSincePhase > this.phaseDuration) {

            this.phase = (this.phase + 1) % 4;

            this.timeSincePhase = 0;

        }



        if (this.input.activePointer.isDown) {

            const mx = this.input.x;

            const my = this.input.y;



            this.blocks.getChildren().forEach(block => {

                const angle = Phaser.Math.Angle.Between(block.x, block.y, mx, my);

                block.x += Math.cos(angle) * 0.6;

                block.y += Math.sin(angle) * 0.6;

            });

        }



        this.animateBlocks(time);

    }

    animateBlocks(time)

    {

        const blocks = this.blocks.getChildren();



        blocks.forEach((block, i) => {

            const orig = this.originalPositions[i];

            let offset = 0;



            switch (this.phase) {

                case 0:

                    offset = Math.sin(time / 300 + orig.y * 0.12) * 12;

                    break;

                case 1:

                    const dx = orig.x - 400;

                    const dy = orig.y - 300;

                    const dist = Math.sqrt(dx*dx + dy*dy);

                    offset = Math.sin(time / 250 + dist * 0.05) * 18;

                    break;

                case 2:

                    offset = Math.sin(time / 220 + (orig.x + orig.y) * 0.06) * 15;

                    break;

                case 3:

                    offset = Math.sin(time / 150 + i) * Phaser.Math.Between(8, 25);

                    break;

            }



            block.x = orig.x + offset;

            block.y = orig.y + offset;

        });

    }

    /** TEXT ENGINE **/

    createTextEngine() {

        const input = document.getElementById("text-input");

        const button = document.getElementById("generate-btn");



        button.addEventListener("click", () => {

            this.generateAnimatedText(input.value.toUpperCase());

        });

    }

    generateAnimatedText(text) {

        if (!text) return;



        const gameWidth = this.sys.game.config.width;

        const startX = gameWidth / 2;

        const startY = 100;



        if (this.letters) {

            this.letters.forEach(l => l.destroy());

        }



        this.letters = [];



        [...text].forEach((char, i) => {

            const letter = this.add.text(startX, startY + i * 40, char, {

                fontFamily: 'Arial',

                fontSize: '40px',

                color: '#ff3eb5'

            }).setOrigin(0.5);



            this.letters.push(letter);



            this.tweens.add({

                targets: letter,

                x: startX + 30,

                angle: 10,

                yoyo: true,

                repeat: -1,

                duration: 800 + i * 30,

                ease: "sine.inout"

            });

        });

    }

}



const config = {

    type: Phaser.AUTO,

    width: Math.floor(window.innerWidth * 0.70),

    height: window.innerHeight,

    backgroundColor: '#b8ffb8',

    parent: 'phaser-example',

    scene: Example

};



new Phaser.Game(config);

</script>



</body>

</html>
