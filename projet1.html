<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Phase 2 — Générateur</title>
<style>
  html,body{height:100%;margin:0;background:#0f1720;font-family:Arial,Helvetica,sans-serif;display:flex;align-items:center;justify-content:center;}
  .scene{position:relative;width:100%;height:100vh;overflow:hidden;}
  canvas{position:absolute;inset:0;}
  .ui{position:absolute;left:16px;top:16px;z-index:10;color:#fff;}
  input[type="text"]{padding:8px 10px;border-radius:6px;border:1px solid rgba(255,255,255,0.12);width:220px;background:rgba(255,255,255,0.03);color:#fff}
  button{margin-left:8px;padding:8px 10px;border-radius:6px;border:none;background:#2b8bd8;color:#fff;cursor:pointer}
  .centerText{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);z-index:9;font-size:40px;font-weight:600;color:#fff;pointer-events:none}
</style>
</head>
<body>
<div class="scene">
  <canvas id="c"></canvas>

  <div class="ui">
    <input id="txt" type="text" maxlength="100" placeholder="Écris un texte">
    <button id="gen">Générer</button>
  </div>

  <div id="center" class="centerText" aria-hidden="true"></div>
</div>

<script>
/* Phase 2 : formes avec animations simples + saisie et génération de texte */
const canvas = document.getElementById('c');
const ctx = canvas.getContext('2d');
function resize(){ canvas.width = innerWidth; canvas.height = innerHeight; }
resize(); addEventListener('resize', resize);

let shapes = [];
function createShapes(){
  shapes = [];
  for(let i=0;i<20;i++){
    shapes.push({
      x: Math.random()*innerWidth,
      y: Math.random()*innerHeight,
      r: 8 + Math.random()*30,
      type: ['circle','square','triangle'][Math.floor(Math.random()*3)],
      speed: 0.2 + Math.random()*0.8,
      phase: Math.random()*Math.PI*2,
      color: ['#ff6b6b','#ffd166','#6bc3ff','#9b8cff'][Math.floor(Math.random()*4)]
    });
  }
}
createShapes();

let time=0;
function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // fond coloré léger
  ctx.fillStyle = 'linear-gradient(180deg, rgba(10,20,30,0.7), rgba(20,30,50,0.7))';
  ctx.fillStyle = '#071427';
  ctx.fillRect(0,0,canvas.width,canvas.height);

  shapes.forEach(s=>{
    const yy = s.y + Math.sin(time*s.speed + s.phase)*20;
    ctx.save();
    ctx.translate(s.x,yy);
    ctx.globalAlpha = 0.85;
    ctx.fillStyle = s.color;
    if(s.type === 'circle') ctx.beginPath(), ctx.arc(0,0,s.r,0,Math.PI*2), ctx.fill();
    else if(s.type === 'square') ctx.fillRect(-s.r,-s.r,s.r*2,s.r*2);
    else {
      ctx.beginPath();
      ctx.moveTo(0,-s.r);
      ctx.lineTo(s.r,s.r);
      ctx.lineTo(-s.r,s.r);
      ctx.closePath();
      ctx.fill();
    }
    ctx.restore();
  });

  time += 0.02;
  requestAnimationFrame(draw);
}
requestAnimationFrame(draw);

// génération de texte centré avec animation d'entrée
const btn = document.getElementById('gen');
const input = document.getElementById('txt');
const center = document.getElementById('center');

btn.addEventListener('click', ()=>{
  const v = input.value.trim() || 'Texte';
  center.textContent = v;
  center.style.transition = 'none';
  center.style.transform = 'translate(-50%, -60%) scale(0.8)';
  center.style.opacity = '0';
  requestAnimationFrame(()=> {
    center.style.transition = 'transform 400ms cubic-bezier(.2,.9,.2,1), opacity 350ms';
    center.style.transform = 'translate(-50%, -50%) scale(1)';
    center.style.opacity = '1';
  });
});
</script>
</body>
</html>
